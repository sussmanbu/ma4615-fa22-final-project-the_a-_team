


<pre class="r"><code>library(here)</code></pre>
<pre><code>## here() starts at /Users/lindasun/Desktop/MA415/ma4615-fa22-final-project-the_a-_team</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages
## ───────────────────────────────────────
## tidyverse 1.3.2 ──</code></pre>
<pre><code>## ✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
## ✔ readr   2.1.3      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(dplyr)
library(AICcmodavg)
library(ggcorrplot)
library(ggplot2)
co2_data &lt;- read_csv(&quot;owid-co2-data.csv&quot;, show_col_types = FALSE)
co2_data1 &lt;- co2_data %&gt;%
  select(-iso_code, -energy_per_gdp, -co2_including_luc_per_unit_energy, -co2_including_luc_per_gdp, -co2_per_unit_energy) %&gt;%
  na.omit() %&gt;%
  filter(country != &quot;World&quot;) %&gt;%
  select(country, gdp, year, population, total_ghg, cement_co2, co2_including_luc, coal_co2, consumption_co2, primary_energy_consumption, oil_co2, flaring_co2, other_industry_co2)

co2_data1</code></pre>
<pre><code>## # A tibble: 1,234 × 13
##    country     gdp  year popul…¹ total…² cemen…³ co2_i…⁴ coal_…⁵ consu…⁶ prima…⁷
##    &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Austra… 4.64e11  1990  1.70e7    541.    3.46    263.    142.    243.   1033.
##  2 Austra… 4.61e11  1991  1.73e7    541.    3.18    231.    146.    244.   1025.
##  3 Austra… 4.78e11  1992  1.75e7    542.    2.92    311.    150.    246.   1042.
##  4 Austra… 5.01e11  1993  1.76e7    544.    3.00    331.    150.    247.   1064.
##  5 Austra… 5.27e11  1994  1.78e7    550.    3.48    315.    151.    256.   1105.
##  6 Austra… 5.49e11  1995  1.80e7    558.    3.36    496.    156.    261.   1154.
##  7 Austra… 5.75e11  1996  1.82e7    557.    3.24    515.    160.    268.   1188.
##  8 Austra… 6.01e11  1997  1.84e7    567.    3.18    458.    168.    275.   1217.
##  9 Austra… 6.34e11  1998  1.86e7    594.    3.48    536.    178.    294.   1246.
## 10 Austra… 6.64e11  1999  1.88e7    633.    3.52    494.    183.    295.   1297.
## # … with 1,224 more rows, 3 more variables: oil_co2 &lt;dbl&gt;, flaring_co2 &lt;dbl&gt;,
## #   other_industry_co2 &lt;dbl&gt;, and abbreviated variable names ¹​population,
## #   ²​total_ghg, ³​cement_co2, ⁴​co2_including_luc, ⁵​coal_co2, ⁶​consumption_co2,
## #   ⁷​primary_energy_consumption</code></pre>
<pre class="r"><code>write_csv(co2_data1, file = here::here(&quot;dataset&quot;, &quot;co2_data1_clean.csv&quot;))
save(co2_data1, file = here::here(&quot;co2_data1_clean.RData&quot;))

model1 &lt;- lm(total_ghg ~ gdp + population + cement_co2 + co2_including_luc + coal_co2 + consumption_co2 + primary_energy_consumption + oil_co2 + flaring_co2 + other_industry_co2, data = co2_data1)
summary(model1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = total_ghg ~ gdp + population + cement_co2 + co2_including_luc + 
##     coal_co2 + consumption_co2 + primary_energy_consumption + 
##     oil_co2 + flaring_co2 + other_industry_co2, data = co2_data1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -709.88  -15.35   -3.38   17.03  757.09 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                 1.053e+01  2.601e+00   4.051 5.43e-05 ***
## gdp                         2.708e-11  5.764e-12   4.698 2.93e-06 ***
## population                 -1.803e-07  6.886e-08  -2.618 0.008958 ** 
## cement_co2                  2.172e+00  2.229e-01   9.745  &lt; 2e-16 ***
## co2_including_luc           7.808e-01  1.229e-02  63.536  &lt; 2e-16 ***
## coal_co2                    3.682e-01  3.774e-02   9.757  &lt; 2e-16 ***
## consumption_co2            -2.876e-01  3.705e-02  -7.762 1.75e-14 ***
## primary_energy_consumption  5.874e-02  5.853e-03  10.037  &lt; 2e-16 ***
## oil_co2                     2.839e-01  5.898e-02   4.813 1.67e-06 ***
## flaring_co2                 2.305e+00  5.951e-01   3.874 0.000113 ***
## other_industry_co2         -7.260e+00  1.156e+00  -6.278 4.76e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 78.17 on 1223 degrees of freedom
## Multiple R-squared:  0.9971, Adjusted R-squared:  0.9971 
## F-statistic: 4.25e+04 on 10 and 1223 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>plot(total_ghg ~ gdp + population + cement_co2 + co2_including_luc + coal_co2 + consumption_co2 + primary_energy_consumption + oil_co2 + flaring_co2 + other_industry_co2, data= co2_data1)</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-1-1.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-2.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-3.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-4.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-5.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-6.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-7.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-8.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-9.png" width="672" /><img src="/analysis_files/figure-html/unnamed-chunk-1-10.png" width="672" /></p>
<pre class="r"><code>modAIC &lt;- MASS::stepAIC(model1, k = 2)</code></pre>
<pre><code>## Start:  AIC=10768.53
## total_ghg ~ gdp + population + cement_co2 + co2_including_luc + 
##     coal_co2 + consumption_co2 + primary_energy_consumption + 
##     oil_co2 + flaring_co2 + other_industry_co2
## 
##                              Df Sum of Sq      RSS   AIC
## &lt;none&gt;                                     7472301 10768
## - population                  1     41871  7514172 10773
## - flaring_co2                 1     91675  7563977 10782
## - gdp                         1    134823  7607125 10789
## - oil_co2                     1    141556  7613857 10790
## - other_industry_co2          1    240804  7713105 10806
## - consumption_co2             1    368138  7840439 10826
## - cement_co2                  1    580189  8052490 10859
## - coal_co2                    1    581608  8053909 10859
## - primary_energy_consumption  1    615473  8087775 10864
## - co2_including_luc           1  24663945 32136247 12567</code></pre>
<pre class="r"><code>modBIC &lt;- MASS::stepAIC(model1, k = log(nrow(co2_data1)))</code></pre>
<pre><code>## Start:  AIC=10824.83
## total_ghg ~ gdp + population + cement_co2 + co2_including_luc + 
##     coal_co2 + consumption_co2 + primary_energy_consumption + 
##     oil_co2 + flaring_co2 + other_industry_co2
## 
##                              Df Sum of Sq      RSS   AIC
## - population                  1     41871  7514172 10825
## &lt;none&gt;                                     7472301 10825
## - flaring_co2                 1     91675  7563977 10833
## - gdp                         1    134823  7607125 10840
## - oil_co2                     1    141556  7613857 10841
## - other_industry_co2          1    240804  7713105 10857
## - consumption_co2             1    368138  7840439 10877
## - cement_co2                  1    580189  8052490 10910
## - coal_co2                    1    581608  8053909 10910
## - primary_energy_consumption  1    615473  8087775 10915
## - co2_including_luc           1  24663945 32136247 12618
## 
## Step:  AIC=10824.61
## total_ghg ~ gdp + cement_co2 + co2_including_luc + coal_co2 + 
##     consumption_co2 + primary_energy_consumption + oil_co2 + 
##     flaring_co2 + other_industry_co2
## 
##                              Df Sum of Sq      RSS   AIC
## &lt;none&gt;                                     7514172 10825
## - gdp                         1     97101  7611274 10833
## - flaring_co2                 1    102493  7616665 10834
## - oil_co2                     1    114648  7628820 10836
## - consumption_co2             1    326270  7840442 10870
## - coal_co2                    1    539836  8054009 10903
## - primary_energy_consumption  1    754188  8268360 10936
## - cement_co2                  1    863767  8377940 10952
## - other_industry_co2          1   1712559  9226731 11071
## - co2_including_luc           1  28729122 36243295 12759</code></pre>
<pre class="r"><code>co2_data2 &lt;- co2_data1 %&gt;%
  select(-country, -year)

correlation_matrix &lt;- round(cor(co2_data2),1)
corrp.mat &lt;- cor_pmat(co2_data2)
ggcorrplot(correlation_matrix, method =&quot;square&quot;)</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-1-11.png" width="672" /></p>
<pre class="r"><code>co2_data2 &lt;- 
  co2_data1 %&gt;% 
  filter(country == &quot;China&quot; | country == &quot;United States&quot; | country == &quot;Russia&quot; | country == &quot;Japan&quot; | country == &quot;Canada&quot;)%&gt;%
  select(country, year, population, total_ghg, co2_including_luc,coal_co2, consumption_co2)
co2_data2</code></pre>
<pre><code>## # A tibble: 145 × 7
##    country  year population total_ghg co2_including_luc coal_co2 consumption_co2
##    &lt;chr&gt;   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;             &lt;dbl&gt;    &lt;dbl&gt;           &lt;dbl&gt;
##  1 Canada   1990   27657206      607.              691.     99.2            483.
##  2 Canada   1991   28015762      603.              674.    104.             482.
##  3 Canada   1992   28347644      617.              687.    107.             495.
##  4 Canada   1993   28668168      613.              686.     98.9            483.
##  5 Canada   1994   28981190      631.              703.    103.             488.
##  6 Canada   1995   29289430      646.              709.    104.             496.
##  7 Canada   1996   29593856      668.              727.    106.             505.
##  8 Canada   1997   29882752      680.              748.    113.             537.
##  9 Canada   1998   30144816      696.              755.    119.             541.
## 10 Canada   1999   30399776      695.              770.    120.             542.
## # … with 135 more rows</code></pre>
<pre class="r"><code>ggplot(data = co2_data2, aes(x = year, y = total_ghg, color = country)) +
    geom_line() +
    facet_wrap(vars(country)) +
    labs(title = &quot;GHG vs year of top five countries&quot;,
         x = &quot;Year&quot;,
         y = &quot;Total emissions&quot;) +
    theme_bw()</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = co2_data2, mapping = aes(x = population, y = total_ghg)) +
    geom_point(alpha = 0.1, aes(color = country))</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>ggplot(data = co2_data2, mapping = aes(x = country, y = total_ghg)) +
    geom_boxplot(alpha = 0) +
    geom_jitter(alpha = 0.3, color = &quot;tomato&quot;) + coord_flip()</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<pre class="r"><code>ggplot(data = co2_data2, aes(x = year, y = total_ghg, color = country)) +
    geom_line()</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-2-4.png" width="672" /></p>
<pre class="r"><code>co2_bubble &lt;- co2_data1 %&gt;%
  group_by(country) %&gt;%
  summarise(n1 = sum(total_ghg)) %&gt;%
  mutate(prop = n1/sum(n1)) %&gt;%
  arrange(desc(prop))%&gt;%
  head(10) %&gt;%
  select(-n1)

co2_bubble</code></pre>
<pre><code>## # A tibble: 10 × 2
##    country          prop
##    &lt;chr&gt;           &lt;dbl&gt;
##  1 China          0.278 
##  2 United States  0.239 
##  3 Russia         0.0712
##  4 Brazil         0.0694
##  5 Japan          0.0478
##  6 Germany        0.0367
##  7 Canada         0.0324
##  8 United Kingdom 0.0252
##  9 Australia      0.0240
## 10 South Korea    0.0195</code></pre>
<pre class="r"><code>total_bubble &lt;- co2_data1 %&gt;%
  filter(country == &quot;China&quot; | country == &quot;United States&quot; | country == &quot;Russia&quot; | country == &quot;Brazil&quot; | country == &quot;Japan&quot;)

total_bubble %&gt;%
  arrange(desc(total_ghg)) %&gt;%
  ggplot(aes(x=year, y=gdp, size=total_ghg, color=country)) +
    geom_point(alpha=0.5) +
    scale_size(range = c(.1, 10), name=&quot;Total emissions&quot;)</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
