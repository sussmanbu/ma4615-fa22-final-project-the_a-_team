---
title: Analysis
description:
toc: true
featuredVideo:
featuredImage: https://upload.wikimedia.org/wikipedia/commons/7/77/Pebbleswithquarzite.jpg
draft: false
---


<div id="TOC">

</div>

<p>This comes from the file <code>content/analysis.Rmd</code>.</p>
<p>We describe here our detailed data analysis.</p>
<pre class="r"><code>library(here)</code></pre>
<pre><code>## here() starts at /Users/lindasun/Desktop/MA415/ma4615-fa22-final-project-the_a-_team</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages
## ───────────────────────────────────────
## tidyverse 1.3.2 ──</code></pre>
<pre><code>## ✔ ggplot2 3.4.0      ✔ purrr   0.3.5 
## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
## ✔ readr   2.1.3      ✔ forcats 0.5.2 
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(dplyr)
co2_data &lt;- read_csv(&quot;owid-co2-data.csv&quot;, show_col_types = FALSE)


co2_data1 &lt;- co2_data %&gt;%
   select(country, year, population, gdp, energy_per_capita, energy_per_gdp, primary_energy_consumption, total_ghg) %&gt;%
  na.omit() 

co2_data1</code></pre>
<pre><code>## # A tibble: 4,628 × 8
##    country      year population         gdp energy_per…¹ energ…² prima…³ total…⁴
##    &lt;chr&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 Afghanistan  1990   10694804 13065984000        2968.   2.43    31.7     9.58
##  2 Afghanistan  1991   10745168 12047362048        1294.   1.15    13.9     9.81
##  3 Afghanistan  1992   12057436 12677538816         760.   0.723    9.17    9.03
##  4 Afghanistan  1993   14003764  9834580992         650.   0.926    9.10    9.11
##  5 Afghanistan  1994   15455560  7919857152         570.   1.11     8.82    9.15
##  6 Afghanistan  1995   16418911 12307525632         452.   0.604    7.43    9.58
##  7 Afghanistan  1996   17106600 12070125568         426.   0.604    7.29   10.6 
##  8 Afghanistan  1997   17788818 11850752000         390.   0.585    6.94   11.6 
##  9 Afghanistan  1998   18493134 11692172288         365.   0.577    6.75   12.4 
## 10 Afghanistan  1999   19262854 11517317120         350.   0.586    6.75   13.3 
## # … with 4,618 more rows, and abbreviated variable names ¹​energy_per_capita,
## #   ²​energy_per_gdp, ³​primary_energy_consumption, ⁴​total_ghg</code></pre>
<pre class="r"><code>library(dplyr)
library(tidyverse)
Agri &lt;- read_csv(&quot;FAOSTAT.csv&quot;, show_col_types = FALSE) 

Agri_land &lt;- 
  Agri %&gt;% 
  filter(str_detect(Item,&quot;Emissions on agricultural land&quot;)) %&gt;%
  filter(str_detect(Element, &quot;CO2eq&quot;)) %&gt;%
  mutate(unit = &quot;tonnes&quot;) %&gt;%
  select(Area, Item, Element, unit, Y1990:Y2018) %&gt;%
  pivot_longer(c(Y1990:Y2018),
               names_to = &quot;year&quot;, values_to = &quot;emission&quot;) %&gt;%
  mutate(total = emission * 1000) %&gt;%
  select(-emission) %&gt;%
  arrange(order(year)) %&gt;%
  group_by(year, Item, Area) %&gt;%
  summarize(sum_emission = sum(total, na.rm = TRUE, count = n()), Element) %&gt;%
  rename(Country = Area, Emission = sum_emission, source_of_emissions = Item, `Element(tonnes)` = Element) %&gt;%
  mutate(year = gsub(&quot;Y&quot;, &quot;&quot;, year)) %&gt;%
  select(-Country) %&gt;%
  ungroup() %&gt;%
  select(-`Element(tonnes)`)%&gt;%
  group_by(Country,year, source_of_emissions) %&gt;%
  summarise(Emissions = sum(Emission)) %&gt;%
  rename(country = Country) %&gt;%
  mutate(country = gsub(&quot;United Kingdom of Great Britain and Northern Ireland&quot;, &quot;United Kingdom&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;United States of America&quot;, &quot;United States&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;Russian Federation&quot;, &quot;Russia&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;Bolivia (Plurinational State of)&quot;, &quot;Bolivia&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;Republic of Moldova&quot;, &quot;Moldova&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;Lao People&#39;s Democratic Republic&quot;, &quot;Laos&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;Syrian Arab Republic&quot;, &quot;Syria&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;United Republic of Tanzania&quot;, &quot;Tanzania&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;Democratic Republic of the Congo&quot;, &quot;Democratic Republic of Congo&quot;, country)) %&gt;%
  mutate(country = gsub(&quot;Iran (Islamic Republic of)&quot;, &quot;Iran&quot;, country))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;Item&#39;, &#39;Area&#39;. You can override
## using the `.groups` argument.
## Adding missing grouping variables: `Country`
## `summarise()` has grouped output by &#39;Country&#39;, &#39;year&#39;. You can override using
## the `.groups` argument.</code></pre>
<pre class="r"><code>Agri_land$year = as.numeric(Agri_land$year)
Agri_land</code></pre>
<pre><code>## # A tibble: 8,149 × 4
## # Groups:   country, year [8,149]
##    country      year source_of_emissions            Emissions
##    &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;                              &lt;dbl&gt;
##  1 Afghanistan  1990 Emissions on agricultural land 51478796.
##  2 Afghanistan  1991 Emissions on agricultural land 53359569.
##  3 Afghanistan  1992 Emissions on agricultural land 52948406.
##  4 Afghanistan  1993 Emissions on agricultural land 53377980.
##  5 Afghanistan  1994 Emissions on agricultural land 53840537.
##  6 Afghanistan  1995 Emissions on agricultural land 56579957.
##  7 Afghanistan  1996 Emissions on agricultural land 63100684.
##  8 Afghanistan  1997 Emissions on agricultural land 69216291.
##  9 Afghanistan  1998 Emissions on agricultural land 74177975.
## 10 Afghanistan  1999 Emissions on agricultural land 80778458.
## # … with 8,139 more rows</code></pre>
<pre class="r"><code>write_csv(Agri_land, file = here::here(&quot;dataset&quot;, &quot;Agri_land_clean.csv&quot;))</code></pre>
<pre class="r"><code>co2_agri &lt;- full_join(co2_data1, Agri_land, by = c(&quot;year&quot;, &quot;country&quot;))

co2_agri &lt;- co2_agri %&gt;% 
  mutate(total_ghg2 = total_ghg * 1000) %&gt;%
  select(-total_ghg) %&gt;%
  filter(country != &quot;World&quot;) %&gt;%
  rename(`Agriculture_emissions(kilotonnes)` = Emissions, `total_ghg(kilotonnes)` = total_ghg2) %&gt;%
  mutate(`Agriculture_emissions(Kilotonnes)`= `Agriculture_emissions(kilotonnes)`/1000) %&gt;%
  select(-`Agriculture_emissions(kilotonnes)`)
    
co2_agri &lt;- co2_agri %&gt;% mutate(agri_ghg_total = rowSums(co2_agri[,c(9,10)])) %&gt;%
  na.omit()

co2_agri</code></pre>
<pre><code>## # A tibble: 4,390 × 11
##    country  year popul…¹     gdp energ…² energ…³ prima…⁴ sourc…⁵ total…⁶ Agric…⁷
##    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 Afghan…  1990  1.07e7 1.31e10   2968.   2.43    31.7  Emissi…    9580  51479.
##  2 Afghan…  1991  1.07e7 1.20e10   1294.   1.15    13.9  Emissi…    9810  53360.
##  3 Afghan…  1992  1.21e7 1.27e10    760.   0.723    9.17 Emissi…    9030  52948.
##  4 Afghan…  1993  1.40e7 9.83e 9    650.   0.926    9.10 Emissi…    9110  53378.
##  5 Afghan…  1994  1.55e7 7.92e 9    570.   1.11     8.82 Emissi…    9150  53841.
##  6 Afghan…  1995  1.64e7 1.23e10    452.   0.604    7.43 Emissi…    9580  56580.
##  7 Afghan…  1996  1.71e7 1.21e10    426.   0.604    7.29 Emissi…   10610  63101.
##  8 Afghan…  1997  1.78e7 1.19e10    390.   0.585    6.94 Emissi…   11580  69216.
##  9 Afghan…  1998  1.85e7 1.17e10    365.   0.577    6.75 Emissi…   12400  74178.
## 10 Afghan…  1999  1.93e7 1.15e10    350.   0.586    6.75 Emissi…   13280  80778.
## # … with 4,380 more rows, 1 more variable: agri_ghg_total &lt;dbl&gt;, and
## #   abbreviated variable names ¹​population, ²​energy_per_capita,
## #   ³​energy_per_gdp, ⁴​primary_energy_consumption, ⁵​source_of_emissions,
## #   ⁶​`total_ghg(kilotonnes)`, ⁷​`Agriculture_emissions(Kilotonnes)`</code></pre>
<pre class="r"><code>write_csv(co2_agri, file = here::here(&quot;dataset&quot;, &quot;co2_agri_clean.csv&quot;))
save(co2_agri, file = here::here(&quot;dataset/co2_agri_clean.RData&quot;))</code></pre>
<pre class="r"><code>co2_total &lt;- co2_agri %&gt;%
  group_by(year) %&gt;%
  summarise(a = sum(agri_ghg_total))%&gt;%
  ggplot(aes(year, a))+
  geom_line() + 
  geom_smooth(method=&quot;lm&quot;, se=F) +
  geom_jitter(width = .5, size=1) +
  labs(subtitle=&quot;Global Total Emissions&quot;, 
       y=&quot;Total Emissions&quot;, 
       x=&quot;Year&quot;, 
       title=&quot;Line Trend&quot;) +
  theme(axis.text.x = element_text(angle = 45, vjust=0.5), 
        panel.grid.minor = element_blank())

co2_total</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/totalline-1.png" width="672" /></p>
<pre class="r"><code>co2_point_pri &lt;- co2_agri %&gt;%
  ggplot(aes(primary_energy_consumption, agri_ghg_total))+
  geom_point(size = 0.5) + 
  geom_smooth(method=&quot;lm&quot;, se=F) +
  labs(subtitle=&quot;Primary energy consumption vs. Total Emission&quot;, 
       y=&quot;Total Emissions&quot;, 
       x=&quot;Primary energy consumption&quot;, 
       title=&quot;Point graph 1&quot;)
  
co2_point_pri</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/point%20primary-1.png" width="672" /></p>
<pre class="r"><code>co2_point_energy1 &lt;- co2_agri %&gt;%
  ggplot(aes(energy_per_capita, agri_ghg_total))+
  geom_point(size = 0.5) + 
  geom_smooth(method=&quot;lm&quot;, se=F) +
  labs(subtitle=&quot;Energy per capita vs. Total Emission&quot;, 
       y=&quot;Total Emissions&quot;, 
       x=&quot;Energy per capita&quot;, 
       title=&quot;Point graph 2&quot;)
  
co2_point_energy1</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/point%20energy1-1.png" width="672" /></p>
<pre class="r"><code>co2_point_energy2 &lt;- co2_agri %&gt;%
  ggplot(aes(energy_per_gdp, agri_ghg_total))+
  geom_point(size = 0.5) + 
  geom_smooth(method=&quot;lm&quot;, se=F) +
  labs(subtitle=&quot;Energy per gdp vs. Total Emission&quot;, 
       y=&quot;Total Emissions&quot;, 
       x=&quot;Energy per gdp&quot;, 
       title=&quot;Point graph 3&quot;)
  
co2_point_energy2</code></pre>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="/analysis_files/figure-html/point%20energy2-1.png" width="672" /></p>
<pre class="r"><code>co2_prop &lt;- co2_agri %&gt;%
  group_by(country) %&gt;%
  summarise(n1 = sum(agri_ghg_total)) %&gt;%
  mutate(prop = n1/sum(n1)) %&gt;%
  arrange(desc(prop))%&gt;%
  head(10) %&gt;%
  select(-n1)

co2_prop</code></pre>
<pre><code>## # A tibble: 10 × 2
##    country                        prop
##    &lt;chr&gt;                         &lt;dbl&gt;
##  1 China                        0.133 
##  2 United States                0.105 
##  3 Brazil                       0.0985
##  4 India                        0.0733
##  5 Indonesia                    0.0631
##  6 Russia                       0.0341
##  7 Democratic Republic of Congo 0.0246
##  8 Australia                    0.0211
##  9 Zambia                       0.0204
## 10 Canada                       0.0200</code></pre>
<pre class="r"><code>co2_facet &lt;- co2_agri %&gt;% 
  filter(country == &quot;China&quot; | country == &quot;Brazil&quot; | country == &quot;India&quot; | country == &quot;Indonesia&quot; | country == &quot;United States&quot;|country == &quot;Zambia&quot;|country ==&quot;Democratic Republic of Congo&quot; |country==&quot;Australia&quot;|country == &quot;Argentina&quot;)%&gt;%
  select(country, year, population, agri_ghg_total)%&gt;%
  ggplot(aes(year, agri_ghg_total, color = country)) +
    geom_line() +
    facet_wrap(vars(country)) +
    labs(title = &quot;Facet wrap&quot;,
         subtitle=&quot;Emissions vs Year (top nine countries)&quot;,
         x = &quot;Year&quot;,
         y = &quot;Total Emissions&quot;) +
    theme_bw()

co2_facet</code></pre>
<p><img src="/analysis_files/figure-html/facet-1.png" width="672" /></p>
<pre class="r"><code>vec &lt;- c(&quot;13.6%&quot;,&quot;9.0%&quot;,&quot;8.6%&quot;,&quot;8.0%&quot;,&quot;6.1%&quot;)

co2_bar &lt;- co2_prop %&gt;%
  filter(country == &quot;China&quot; | country == &quot;Brazil&quot; | country == &quot;India&quot; | country == &quot;Indonesia&quot; | country == &quot;United States&quot;) %&gt;%
  ggplot(aes(x = country, y = prop, fill = country)) +
  geom_bar(stat=&quot;identity&quot;, width=1) +
  geom_text(aes(label = vec), vjust = 0) +
  labs(title = &quot;Bar graph&quot;,
      subtitle=&quot;Rank of top 5 countries&#39; emissions&quot;,
      x = &quot;Country&quot;, y = &quot;Total Emissions&quot;)

co2_bar</code></pre>
<p><img src="/analysis_files/figure-html/bar-1.png" width="672" /></p>
<pre class="r"><code>co2_bar2 &lt;- co2_agri %&gt;%
  filter(country == &quot;China&quot; | country == &quot;Brazil&quot; | country == &quot;India&quot; | country == &quot;Indonesia&quot; | country == &quot;United States&quot;) %&gt;%
  ggplot(aes(x = country, y = `Agriculture_emissions(Kilotonnes)`, fill = country)) +
  geom_bar(stat=&quot;identity&quot;, width=1) +
  labs(subtitle=&quot;Agricultural land Emission of top 5 countries&quot;, 
       y=&quot;Agricultural land Emission&quot;, 
       x=&quot;Country&quot;, 
       title=&quot;Bar graph 2&quot;)

co2_bar2 </code></pre>
<p><img src="/analysis_files/figure-html/bar2-1.png" width="672" /></p>
<pre class="r"><code>co2_box &lt;- co2_agri %&gt;% 
  filter(country == &quot;China&quot; | country == &quot;Brazil&quot; | country == &quot;India&quot; | country == &quot;Indonesia&quot; | country == &quot;United States&quot;) %&gt;%
  ggplot(aes(country, primary_energy_consumption)) + 
  geom_boxplot(aes(fill=country, alpha = 0)) + 
  geom_jitter(alpha = 0.3, color = &quot;Tomato&quot;) +
  labs(x = &quot;Country&quot;, 
       y = &quot;Primary Energy Consumption&quot;, 
       subtitle=&quot;Primary energy consumption of top 5 countries&quot;,
       fill=&#39;Country&#39;, 
       title= &quot;Boxplot 1&quot;) 

 co2_box</code></pre>
<p><img src="/analysis_files/figure-html/boxplot-1.png" width="672" /></p>
<pre class="r"><code>co2_violin &lt;- co2_agri %&gt;%
  filter(country == &quot;China&quot; | country == &quot;Brazil&quot; | country == &quot;India&quot; | country == &quot;Indonesia&quot; | country == &quot;United States&quot;) %&gt;%
  ggplot() +
  geom_violin(aes(x = country, y= energy_per_gdp, color = country)) + 
  labs(title=&quot;Violin plot&quot;, 
       subtitle=&quot;Energy per GDP of top 5 countries&quot;,
       x=&quot;Country&quot;,
       y=&quot;Energy per GDP&quot;)

co2_violin</code></pre>
<p><img src="/analysis_files/figure-html/voilin-1.png" width="672" /></p>
<p>install.packages(“ggthemes”)</p>
<pre class="r"><code>library(ggplot2)
library(ggthemes)
co2_box2 &lt;- co2_agri %&gt;%
  filter(country == &quot;China&quot; | country == &quot;Brazil&quot; | country == &quot;India&quot; | country == &quot;Indonesia&quot; | country == &quot;United States&quot;) %&gt;%
  ggplot(aes(country, energy_per_capita)) +
  geom_boxplot(aes(fill=country, alpha = 0)) + 
  geom_jitter(alpha = 0.5, color = &quot;Tomato&quot;) + 
      labs(title=&quot;Boxplot 2&quot;, 
           subtitle=&quot;Energy per capita of top 5 countries&quot;,
           x=&quot;Country&quot;,
           y=&quot;Energy per capita&quot;)

co2_box2</code></pre>
<p><img src="/analysis_files/figure-html/boxplot2-1.png" width="672" /></p>
<pre class="r"><code>co2_bubble &lt;- co2_agri %&gt;%
  filter(country == &quot;China&quot; | country == &quot;Brazil&quot; | country == &quot;India&quot; | country == &quot;Indonesia&quot; | country == &quot;United States&quot;) %&gt;%
  ggplot(aes(x= year, y= agri_ghg_total, size= population, color = country)) +
    geom_point(alpha=0.5) +
    scale_size(range = c(.1, 10), name=&quot;Population&quot;) +
  labs(title=&quot;Bubble plot&quot;, 
       subtitle=&quot;Year/Total Emissions/Population of top 5 countries&quot;,
       x = &quot;Year&quot;, y = &quot;Total Emissions&quot;)

co2_bubble</code></pre>
<p><img src="/analysis_files/figure-html/bubble-1.png" width="672" /></p>
<p>install.packages(“ggrepel”)</p>
<pre class="r"><code>library(here)
library(tidyverse)
library(dplyr)
library(AICcmodavg)
library(ggcorrplot)
library(ggplot2)

model1 &lt;- lm(agri_ghg_total ~ population + gdp + energy_per_capita + energy_per_gdp + primary_energy_consumption, data = co2_agri)

summary(model1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = agri_ghg_total ~ population + gdp + energy_per_capita + 
##     energy_per_gdp + primary_energy_consumption, data = co2_agri)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2117547  -173298  -133669   -27897  8432463 
## 
## Coefficients:
##                              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                 1.814e+05  1.641e+04  11.059  &lt; 2e-16 ***
## population                  4.620e-03  1.012e-04  45.672  &lt; 2e-16 ***
## gdp                         2.257e-07  2.773e-08   8.139 5.14e-16 ***
## energy_per_capita          -1.628e+00  3.591e-01  -4.533 5.96e-06 ***
## energy_per_gdp              1.549e+03  8.010e+03   0.193    0.847    
## primary_energy_consumption  1.713e+02  1.441e+01  11.884  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 707400 on 4384 degrees of freedom
## Multiple R-squared:  0.7904, Adjusted R-squared:  0.7902 
## F-statistic:  3306 on 5 and 4384 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>plot(agri_ghg_total ~ population + gdp + energy_per_capita + energy_per_gdp + primary_energy_consumption, data = co2_agri)</code></pre>
<p><img src="/analysis_files/figure-html/modeling-1.png" width="672" /><img src="/analysis_files/figure-html/modeling-2.png" width="672" /><img src="/analysis_files/figure-html/modeling-3.png" width="672" /><img src="/analysis_files/figure-html/modeling-4.png" width="672" /><img src="/analysis_files/figure-html/modeling-5.png" width="672" /></p>
<pre class="r"><code>modAIC &lt;- MASS::stepAIC(model1, k = 2)</code></pre>
<pre><code>## Start:  AIC=118266.8
## agri_ghg_total ~ population + gdp + energy_per_capita + energy_per_gdp + 
##     primary_energy_consumption
## 
##                              Df  Sum of Sq        RSS    AIC
## - energy_per_gdp              1 1.8719e+10 2.1938e+15 118265
## &lt;none&gt;                                     2.1938e+15 118267
## - energy_per_capita           1 1.0284e+13 2.2040e+15 118285
## - gdp                         1 3.3150e+13 2.2269e+15 118331
## - primary_energy_consumption  1 7.0674e+13 2.2644e+15 118404
## - population                  1 1.0438e+15 3.2375e+15 119973
## 
## Step:  AIC=118264.8
## agri_ghg_total ~ population + gdp + energy_per_capita + primary_energy_consumption
## 
##                              Df  Sum of Sq        RSS    AIC
## &lt;none&gt;                                     2.1938e+15 118265
## - energy_per_capita           1 1.3634e+13 2.2074e+15 118290
## - gdp                         1 3.4613e+13 2.2284e+15 118332
## - primary_energy_consumption  1 7.4034e+13 2.2678e+15 118409
## - population                  1 1.0509e+15 3.2446e+15 119981</code></pre>
<pre class="r"><code>modBIC &lt;- MASS::stepAIC(model1, k = log(nrow(co2_agri)))</code></pre>
<pre><code>## Start:  AIC=118305.1
## agri_ghg_total ~ population + gdp + energy_per_capita + energy_per_gdp + 
##     primary_energy_consumption
## 
##                              Df  Sum of Sq        RSS    AIC
## - energy_per_gdp              1 1.8719e+10 2.1938e+15 118297
## &lt;none&gt;                                     2.1938e+15 118305
## - energy_per_capita           1 1.0284e+13 2.2040e+15 118317
## - gdp                         1 3.3150e+13 2.2269e+15 118363
## - primary_energy_consumption  1 7.0674e+13 2.2644e+15 118436
## - population                  1 1.0438e+15 3.2375e+15 120005
## 
## Step:  AIC=118296.7
## agri_ghg_total ~ population + gdp + energy_per_capita + primary_energy_consumption
## 
##                              Df  Sum of Sq        RSS    AIC
## &lt;none&gt;                                     2.1938e+15 118297
## - energy_per_capita           1 1.3634e+13 2.2074e+15 118316
## - gdp                         1 3.4613e+13 2.2284e+15 118357
## - primary_energy_consumption  1 7.4034e+13 2.2678e+15 118434
## - population                  1 1.0509e+15 3.2446e+15 120007</code></pre>
<pre class="r"><code>co2_agri1 &lt;- co2_agri %&gt;%
  select(-year, -country, -source_of_emissions, -agri_ghg_total, -`total_ghg(kilotonnes)`)
correlation_matrix &lt;- round(cor(co2_agri1),1)
corrp.mat &lt;- cor_pmat(co2_agri1)
ggcorrplot(correlation_matrix, method =&quot;square&quot;)</code></pre>
<p><img src="/analysis_files/figure-html/modeling-6.png" width="672" /></p>
<p>install.packages(“regsubsets”)</p>
<pre class="r"><code>library(leaps)
regfit_fwd = regsubsets(agri_ghg_total ~ population + gdp + energy_per_capita + energy_per_gdp + primary_energy_consumption, data = co2_agri, nvmax = 19, method = &quot;forward&quot;)

summary(regfit_fwd)</code></pre>
<pre><code>## Subset selection object
## Call: regsubsets.formula(agri_ghg_total ~ population + gdp + energy_per_capita + 
##     energy_per_gdp + primary_energy_consumption, data = co2_agri, 
##     nvmax = 19, method = &quot;forward&quot;)
## 5 Variables  (and intercept)
##                            Forced in Forced out
## population                     FALSE      FALSE
## gdp                            FALSE      FALSE
## energy_per_capita              FALSE      FALSE
## energy_per_gdp                 FALSE      FALSE
## primary_energy_consumption     FALSE      FALSE
## 1 subsets of each size up to 5
## Selection Algorithm: forward
##          population gdp energy_per_capita energy_per_gdp
## 1  ( 1 ) &quot; &quot;        &quot;*&quot; &quot; &quot;               &quot; &quot;           
## 2  ( 1 ) &quot;*&quot;        &quot;*&quot; &quot; &quot;               &quot; &quot;           
## 3  ( 1 ) &quot;*&quot;        &quot;*&quot; &quot; &quot;               &quot; &quot;           
## 4  ( 1 ) &quot;*&quot;        &quot;*&quot; &quot;*&quot;               &quot; &quot;           
## 5  ( 1 ) &quot;*&quot;        &quot;*&quot; &quot;*&quot;               &quot;*&quot;           
##          primary_energy_consumption
## 1  ( 1 ) &quot; &quot;                       
## 2  ( 1 ) &quot; &quot;                       
## 3  ( 1 ) &quot;*&quot;                       
## 4  ( 1 ) &quot;*&quot;                       
## 5  ( 1 ) &quot;*&quot;</code></pre>
<pre class="r"><code>library(dplyr)
top_5_count &lt;- co2_agri %&gt;%
  select(&quot;country&quot;, &quot;year&quot;, &quot;agri_ghg_total&quot;) %&gt;%
  filter(!str_detect(country, &quot;World&quot;)) %&gt;%
  filter(year == 2018) %&gt;%
  mutate(rank = dense_rank(desc(agri_ghg_total))) %&gt;%
  filter(rank &lt;=5) %&gt;%
  arrange(rank)
top_5_count</code></pre>
<pre><code>## # A tibble: 5 × 4
##   country        year agri_ghg_total  rank
##   &lt;chr&gt;         &lt;dbl&gt;          &lt;dbl&gt; &lt;int&gt;
## 1 China          2018      16287451.     1
## 2 United States  2018       8988841.     2
## 3 India          2018       7960357.     3
## 4 Brazil         2018       6624784.     4
## 5 Indonesia      2018       5162718.     5</code></pre>
<pre class="r"><code>top5 &lt;- co2_agri %&gt;%
  filter(country %in% pull(top_5_count, country)) %&gt;%
  filter(year &gt;=1990) %&gt;%
  ggplot(aes(year, gdp, color = country)) +
  geom_line()+
  scale_color_viridis_d()

top5</code></pre>
<p><img src="/analysis_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
