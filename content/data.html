---
title: Data
description:
toc: true
featuredVideo:
featuredImage: images/data-import-cheatsheet-thumbs.png
draft: false
---


<div id="TOC">

</div>

<hr />
<div id="data-source" class="section level2">
<h2><strong>Data source</strong></h2>
<ul>
<li>Global climate change has always been a heated topic worldwide. Since the Paris Climate Agreement was signed in 2015, major countries have taken action to cut CO2 emissions and to operate cleaner and greener. The United States, being the top emitter of CO2 in the world, is an effective representative for us to analyze how far we are in reaching the goal. Therefore, in this project, we will be looking at the CO2 emission trends of the United States in the period <code>2015 - 2019</code>. In particular, we will choose flight, agriculture, and vehicle industry as the focal factors in our study.</li>
</ul>
</div>
<div id="links-to-the-original-data-sources-airline" class="section level2">
<h2><strong>Links to the original data sources (Airline):</strong></h2>
<ul>
<li><p><a href="https://stats.oecd.org/Index.aspx?QueryId=105629#" class="uri">https://stats.oecd.org/Index.aspx?QueryId=105629#</a></p>
<ul>
<li>Attribution: OECD (The Organisation for Economic Co-operation and Development)</li>
</ul></li>
</ul>
<p><strong>Data collection</strong></p>
<ul>
<li><p>The second dataset is a record of CO2 emissions in the flight industry. <code>OECD</code> (The Organization for Economic Co-operation and Development) collects this data. This organization collects global data to work with governments and policymakers to solve problems facing society and the environment and to find solutions to these problems. Specifically, it provides the estimated CO2 emission data from 186 countries worldwide.</p></li>
<li><p>The dataset includes four parts —— passenger, commercial, freight, and general aviation flight sectors. <code>ICAO</code> collected and provided the data source, and <code>OECD</code> estimated based on ICAO data. They used a database built by the <code>International Civil Aviation Organisation (ICAO)</code> as the source of their estimation. This <code>ICAO</code> database records the departure and arrival airports, the operating airline, and the type of aircraft used for each flight. From this information, coupled with the CO2 calculator provided by Eurocontrol, <code>OECD</code> was able to create an accurate estimation for CO2 emission vs. flights dataset. We use this dataset as the other indicating factor as we try to model the CO2 emission in the vehicle industry.</p></li>
</ul>
<p><strong>Data cleaning</strong></p>
<ul>
<li>First, according to the scope of the study determined by the group, we will focus on CO2 emissions in the United States. Using <code>filter()</code> and <code>values_drop_na</code> to narrow down and ignore NAs. We only research on time from 2015 - 2019. To clarify the dataset, I use <code>arrange()</code> to arrange data by time. In this way, we can see the trend of emissions by year. For the dataset I found, there are repeated columns with redundant information. Thus, I used <code>select()</code> to remove some irrelevant columns to our research topic. For the convenience of combining the three datasets we found, I <code>rename()</code> all of the titles of variables matching in the other two datasets. In order to match the number of columns between two datasets, I only keep the most important variable: <code>source of emissions</code>. I used <code>select()</code> to keep the variables I wanted. Finally, <code>ungroup()</code> ensures future data management.</li>
</ul>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages
## ───────────────────────────────────────
## tidyverse 1.3.2 ──</code></pre>
<pre><code>## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.6     ✔ stringr 1.4.0
## ✔ tidyr   1.2.0     ✔ forcats 0.5.2
## ✔ readr   2.1.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>air1 &lt;- read_csv(&quot;AIRTRANS_CO2.csv&quot;, show_col_types = FALSE) %&gt;% 
  filter(LOCATION == &quot;USA&quot;, values_drop_na = TRUE) %&gt;% 
  filter(Time &gt; 2014 &amp; Time &lt; 2020) %&gt;%
  arrange(Time) %&gt;% 
  select(-POLLUTANT, -MEASURE, -FLIGHT, -FREQUENCY, -SOURCE, -SEASONALITY, -TIME, -`Flag Codes`, -Flags, -Pollutant, -LOCATION) %&gt;%
  rename(flight_type = `Flight type`, source_of_emissions = `Source of emissions`, Year = Time, Emission = Value, `Element(tonnes)` = Measure) %&gt;%
  rename(year = Year) %&gt;%
  select(-Frequency, -Seasonality) %&gt;%
  select(Country, year, source_of_emissions, Emission, `Element(tonnes)`) %&gt;%
  ungroup() 

air1</code></pre>
<pre><code>## # A tibble: 180 × 5
##    Country       year  source_of_emissions            Emission `Element(tonnes)`
##    &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;                             &lt;dbl&gt; &lt;chr&gt;            
##  1 United States 2015  &quot;\&quot;(A) - Domestic flight in …    1.31e8 tonnes of CO2-eq…
##  2 United States 2015  &quot;\&quot;(B) - Domestic flight out…    2.66e7 tonnes of CO2-eq…
##  3 United States 2015  &quot;\&quot;(C) - Domestic flight in …    2.66e6 tonnes of CO2-eq…
##  4 United States 2015  &quot;\&quot;(D) - International fligh…    2.47e7 tonnes of CO2-eq…
##  5 United States 2015  &quot;\&quot;(E) - International fligh…    5.06e7 tonnes of CO2-eq…
##  6 United States 2015  &quot;\&quot;(F) - International fligh…    2.74e7 tonnes of CO2-eq…
##  7 United States 2015  &quot;\&quot;(G) - International fligh…    4.29e7 tonnes of CO2-eq…
##  8 United States 2015  &quot;Air transport - Industry H5…    1.54e8 tonnes of CO2-eq…
##  9 United States 2015  &quot;Bridging item - Residents a…    4.95e7 tonnes of CO2-eq…
## 10 United States 2015  &quot;Bridging item - Non-residen…    2.66e6 tonnes of CO2-eq…
## # … with 170 more rows</code></pre>
<p><strong>Variables explanation</strong></p>
<ul>
<li><p><strong>Domestic aviation</strong>: It is the domestic flights that takes place entirely in one country, which means the departure and arrival cities are all the in same country—-U.S. CO2 is the largest component of aircraft emissions, accounting for approximately 70 percent of the exhaust.</p></li>
<li><p><strong>International aviation</strong>:Flying to a different country is referred to as an international flight. It is made through international airports and keeps tourism and trade between countries alive at the same time.</p></li>
</ul>
</div>
<div id="links-to-the-original-data-sources-agriculture" class="section level2">
<h2><strong>Links to the original data sources (Agriculture):</strong></h2>
<ul>
<li><p><a href="https://www.kaggle.com/datasets/ankitpranay/global-emissions-from-agriculture-and-forest-land?resource=download" class="uri">https://www.kaggle.com/datasets/ankitpranay/global-emissions-from-agriculture-and-forest-land?resource=download</a></p></li>
<li><p>Attribution: Ankit Pranay on Kaggle</p></li>
</ul>
<p><strong>Data collection</strong></p>
<ul>
<li><p>The Global emissions from agriculture and forest land is collected by the website Kaggle. This organization collects data to investigate the main contributions of increasing global greenhouse emissions and tries to solve the crux of environmental issues in the past few decades.</p></li>
<li><p>The FAOSTAT domain Emissions Totals summarize the <code>greenhouse gas (GHG) emissions</code> disseminated in the FAOSTAT Climate Change Emissions domains, generated from agriculture and forest land. They consist of methane (CH4), nitrous oxide (N2O), and carbon dioxide (CO2) emissions from crop and livestock activities and forest management and include land use and land-use change processes. Data are computed at Tier 1 of the IPCC Guidelines for National greenhouse gas (GHG) Inventories.</p></li>
</ul>
<p><strong>Data cleaning</strong></p>
<ul>
<li><p>After researching the factors that cause the increasing CO2 emissions, I found that <code>agriculture/land use</code> is one of the main contributors to CO2 emissions. Analyzing the data on agriculture helps to figure out the trend of CO2 emission. So I found the dataset about agriculture.</p></li>
<li><p>After exploring the dataset, I first filtered out the region and time. We focus on the data from 2015 to 2019 in the United States for all three datasets. And then, I filtered the emission element, which is CO2 emission. In order to make three datasets uniform, I added a new column for the unit “tonnes” by using <code>mutate()</code>, so that it matches the other two datasets. Then I changed the emission values by multiplying 1000 to convert it to tonnes. I selected the columns I needed by <code>select()</code>. To make the dataset more organized and easy to read, I renamed several variables to make them coherent with the other two datasets. Since the original dataset is wide, I change the format of the dataset by using <code>pivot_longer</code>. So that the year becomes the rows and the whole table looks clear and concise.</p></li>
</ul>
<pre class="r"><code>library(dplyr)
library(tidyverse)
Agri &lt;- read_csv(&quot;FAOSTAT.csv&quot;, show_col_types = FALSE) 

Agri2 &lt;- 
  Agri %&gt;% filter(Area == &quot;United States of America&quot;) %&gt;%
  filter(str_detect(Element, &quot;CO2eq&quot;)) %&gt;%
  mutate(unit = &quot;tonnes&quot;) %&gt;%
  select(Area, Item, Element, unit, Y2015:Y2019) %&gt;%
  pivot_longer(c(Y2015:Y2019),
               names_to = &quot;year&quot;, values_to = &quot;emission&quot;) %&gt;%
  mutate(total = emission * 1000) %&gt;%
  select(-emission) %&gt;%
  arrange(order(year)) %&gt;%
  group_by(year, Item, Area) %&gt;%
  summarize(sum_emission = sum(total, na.rm = TRUE, count = n()), Element) %&gt;%
  rename(Country = Area, Emission = sum_emission, source_of_emissions = Item, `Element(tonnes)` = Element) %&gt;%
  mutate(year = gsub(&quot;Y&quot;, &quot;&quot;, year)) %&gt;%
  select(-Country) %&gt;%
  ungroup()</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;Item&#39;, &#39;Area&#39;. You can override
## using the `.groups` argument.
## Adding missing grouping variables: `Country`</code></pre>
<pre class="r"><code>Agri2</code></pre>
<pre><code>## # A tibble: 445 × 5
##    Country                  year  source_of_emissio… Emission `Element(tonnes)` 
##    &lt;chr&gt;                    &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;             
##  1 United States of America 2015  AFOLU                4.47e8 Emissions (CO2eq)…
##  2 United States of America 2015  AFOLU                4.47e8 Emissions (CO2eq)…
##  3 United States of America 2015  AFOLU                4.47e8 Emissions (CO2eq)…
##  4 United States of America 2015  Agricultural Soils   9.09e8 Emissions (CO2eq)…
##  5 United States of America 2015  Agricultural Soils   9.09e8 Emissions (CO2eq)…
##  6 United States of America 2015  Agricultural Soils   9.09e8 Emissions (CO2eq)…
##  7 United States of America 2015  Agricultural Soils   9.09e8 Emissions (CO2eq)…
##  8 United States of America 2015  Burning - Crop re…   9.06e6 Emissions (CO2eq)…
##  9 United States of America 2015  Burning - Crop re…   9.06e6 Emissions (CO2eq)…
## 10 United States of America 2015  Burning - Crop re…   9.06e6 Emissions (CO2eq)…
## # … with 435 more rows</code></pre>
<p><strong>Variables explanations</strong></p>
<ul>
<li><p>The emission primarily alludes to <code>GHG(greenhouse gas)</code>, and while CO2 accounts for about 76 percent of total greenhouse gas emissions, we mainly focus on <code>CO2 emissions</code> in our project. The emission connects strictly with the conditions of climate, so it can be an important index to judge the climate situation. In our project, emission is a dependent variable that can be influenced by many independent variables that I will mention in the following.</p></li>
<li><p><strong>AFOLU</strong>: AFOLU is abbreviation of Agriculture, Forestry and other land use. It can be considered as a sector that contributes to the emission.</p></li>
<li><p><strong>farm-gate emission</strong>: Field to Farm Gate refers to the emissions caused by the act of growing a specific ingredient before any factory, processing, transportation, or distribution emissions.</p></li>
<li><p><strong>Enteric Fermentation</strong>: It is a natural part of the digestive process in ruminant animals such as cattle, sheep, goats, and buffalo. Methane will produced by enteric fermentation as a by-product.</p></li>
<li><p><strong>IPCC Agricultural</strong>: Intergovernmental panel on climate change.The following sectors are included: energy, industrial processes, agriculture, land-use change and forestry, and waste.</p></li>
<li><p><strong>Emission on agricultural land</strong>: It refers to the share of land area that is arable, under permanent crops, and under permanent pastures.Most farm-related emissions come in the form of methane and nitrogenous oxide.
Enteric Fermentation: It is a natural part of the digestive process in ruminant animals such as cattle, sheep, goats, and buffalo. Methane will produced by enteric fermentation as a by-product.</p></li>
</ul>
</div>
<div id="links-to-the-original-data-sources-vehicle" class="section level2">
<h2><strong>Links to the original data sources (Vehicle):</strong></h2>
<ul>
<li><p><a href="https://www.bts.gov/content/number-us-aircraft-vehicles-vessels-and-other-conveyances" class="uri">https://www.bts.gov/content/number-us-aircraft-vehicles-vessels-and-other-conveyances</a></p>
<ul>
<li>Attribution: Bureau of Transportation Statistics official website</li>
</ul></li>
</ul>
<p><strong>Data collection</strong></p>
<ul>
<li>The third dataset collects information about the number of U.S. Aircraft, Vehicles, Vessels, and Other Conveyances. It is found on the Bureau of Transportation Statistics official website. The reason why we use this dataset is because we want to find the relationship between the <code>total emissions</code> and the <code>vehicle number change</code> in the United States. We want to find how different types of vehicle are related to the emission amount.</li>
</ul>
<p><strong>Data cleaning</strong></p>
<ul>
<li>Since we had already combined emissions on Airplanes and Agriculture by rows, I used <code>filter()</code> to remove the Air carrier column. Also, we want to find the effect of vehicles on CO2 emissions; I used <code>filter()</code> to filter out the water vehicles. Thus, only Highway vehicles and Rail Transportation were kept in the dataset. The title of the types of vehicles is missing. I used <code>ls()</code> to list all of the variables’ names, and then I <code>rename()</code> the title for the types of vehicles. Finally, the dataset is too wide, and years are all layout as variables. It will need to be clarified for future interpretation because the same observation cannot be across multiple columns. Thus, I used <code>pivot_longer()</code> to make the dataset longer rather than wide. As before, we <code>arrange()</code> years for straightforward interpretation.</li>
</ul>
<pre class="r"><code>library(dplyr)
library(tidyverse)
vehi &lt;- read_csv(&quot;Vehicle.csv&quot;, show_col_types = FALSE, skip = 1,
                 col_types = cols(
                   value = col_number()
                 ))</code></pre>
<pre><code>## New names:
## • `` -&gt; `...1`</code></pre>
<pre><code>## Warning: The following named parsers don&#39;t match the column names: value</code></pre>
<pre class="r"><code>vehi1 &lt;- vehi %&gt;%
  filter(!row_number() %in% c(1,2,3,23,24,27:95)) %&gt;%
  rename(source_of_emissions = ...1) %&gt;%
  select(source_of_emissions, &quot;2015&quot;:&quot;2019&quot;) %&gt;%
  pivot_longer(c(&quot;2015&quot;:&quot;2019&quot;), names_to = &quot;year&quot;)%&gt;%
  arrange(year) %&gt;% na.omit(vehi) %&gt;% rename(type_of_cars = source_of_emissions)

vehi1</code></pre>
<pre><code>## # A tibble: 90 × 3
##    type_of_cars                              year  value      
##    &lt;chr&gt;                                     &lt;chr&gt; &lt;chr&gt;      
##  1 Highway, total (registered vehicles)      2015  263,610,219
##  2 Light duty vehicle, short wheel basec,d   2015  189,618,308
##  3 Motorcycled                               2015  8,600,936  
##  4 Light duty vehicle, long wheel basec      2015  53,298,884 
##  5 Truck, single-unit 2-axle 6-tire or moref 2015  8,456,302  
##  6 Truck, combinatione,f                     2015  2,746,882  
##  7 Bus                                       2015  888,907    
##  8 Motor bush                                2015  63,573     
##  9 Light rail carsi                          2015  2,478      
## 10 Heavy rail cars                           2015  10,737     
## # … with 80 more rows</code></pre>
<p><strong>Variables explanation</strong></p>
<ul>
<li><p><strong>highway</strong>: It is a public or private road or other public way on land. Transportation on highway can produce a large amount of emission every year.</p></li>
<li><p><strong>bus</strong>: It is a large motor vehicle carrying passengers by road. Bus is a public transportation tool that takes many people at the same time, so it improves energy efficiency. It produces less emissions compared with nonpublic transportation tools like cars. Buses can reduce carbon emissions by as much as 37 million metric tons per year
Amtrak(passenger train car):It operates inter-city rail service in 46 of the 48 contiguous U.S. States. Passenger train car solely takes people. The emissions for rail were computed under the assumption that an Amtrak uses 2.2 gallons of fuel per mile, and the locomotives produce about 33.6 Kg of CO2e per mile.</p></li>
</ul>
</div>
<div id="code-combined-multiple-data-files" class="section level2">
<h2><strong>Code combined multiple data files</strong></h2>
<pre class="r"><code>Agri_air &lt;- rbind(Agri2, air1)
Agri_air</code></pre>
<pre><code>## # A tibble: 625 × 5
##    Country                  year  source_of_emissio… Emission `Element(tonnes)` 
##    &lt;chr&gt;                    &lt;chr&gt; &lt;chr&gt;                 &lt;dbl&gt; &lt;chr&gt;             
##  1 United States of America 2015  AFOLU                4.47e8 Emissions (CO2eq)…
##  2 United States of America 2015  AFOLU                4.47e8 Emissions (CO2eq)…
##  3 United States of America 2015  AFOLU                4.47e8 Emissions (CO2eq)…
##  4 United States of America 2015  Agricultural Soils   9.09e8 Emissions (CO2eq)…
##  5 United States of America 2015  Agricultural Soils   9.09e8 Emissions (CO2eq)…
##  6 United States of America 2015  Agricultural Soils   9.09e8 Emissions (CO2eq)…
##  7 United States of America 2015  Agricultural Soils   9.09e8 Emissions (CO2eq)…
##  8 United States of America 2015  Burning - Crop re…   9.06e6 Emissions (CO2eq)…
##  9 United States of America 2015  Burning - Crop re…   9.06e6 Emissions (CO2eq)…
## 10 United States of America 2015  Burning - Crop re…   9.06e6 Emissions (CO2eq)…
## # … with 615 more rows</code></pre>
<pre class="r"><code>save(Agri2, air1, file = &quot;Agri_air.csv&quot;)</code></pre>
<pre class="r"><code>Agri_air_car &lt;- left_join(Agri_air, vehi1, by = &quot;year&quot;)
Agri_air_car</code></pre>
<pre><code>## # A tibble: 11,250 × 7
##    Country  year  source_of_emissi… Emission `Element(tonnes… type_of_cars value
##    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;
##  1 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Highway, to… 263,…
##  2 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Light duty … 189,…
##  3 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Motorcycled  8,60…
##  4 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Light duty … 53,2…
##  5 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Truck, sing… 8,45…
##  6 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Truck, comb… 2,74…
##  7 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Bus          888,…
##  8 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Motor bush   63,5…
##  9 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Light rail … 2,478
## 10 United … 2015  AFOLU               4.47e8 Emissions (CO2e… Heavy rail … 10,7…
## # … with 11,240 more rows</code></pre>
<pre class="r"><code>save(Agri2, air1, vehi1, file = &quot;Agri_air_car.RData&quot;)
save(Agri2, air1, vehi1, file = &quot;Agri_air_car.csv&quot;)</code></pre>
</div>
