---
title: blogpost4
author: The_A+_team
date: '2022-11-03'
slug: []
categories: []
tags: []
description: ~
toc: yes
authors: []
series: []
lastmod: '2022-11-03T23:33:20-04:00'
featuredVideo: ~
featuredImage: ~
---


<div id="TOC">

</div>

<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages
## ───────────────────────────────────────
## tidyverse 1.3.2 ──</code></pre>
<pre><code>## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.6     ✔ stringr 1.4.0
## ✔ tidyr   1.2.0     ✔ forcats 0.5.2
## ✔ readr   2.1.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>air1 &lt;- read_csv(&quot;AIRTRANS_CO2.csv&quot;, show_col_types = FALSE) %&gt;% 
  filter(LOCATION == &quot;USA&quot;, values_drop_na = TRUE) %&gt;% 
  arrange(order(Time)) %&gt;% 
  select(-POLLUTANT, -MEASURE, -FLIGHT, -FREQUENCY, -SOURCE, -SEASONALITY, -TIME, -`Flag Codes`, -Flags, -Pollutant, -LOCATION) %&gt;% 
  filter(Time &gt; 2014 &amp; Time &lt; 2020) %&gt;% 
  rename(flight_type = `Flight type`, source_of_emissions = `Source of emissions`, Year = Time, Emission = Value) %&gt;%
  ungroup() </code></pre>
<pre class="r"><code>air1 %&gt;% ggplot(aes(x = Year, y = Emission)) +
  geom_point(aes(color = flight_type), size = 1) +
  stat_smooth(aes(group = flight_type), color=&#39;black&#39;, alpha = 0.5, geom = &quot;line&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/EDA1-1.png" width="672" /></p>
<pre class="r"><code>air1 %&gt;% ggplot(aes(factor(flight_type), Emission)) +
  geom_boxplot()</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/EDA1-2.png" width="672" /></p>
<pre class="r"><code>air1 %&gt;% ggplot(aes(factor(source_of_emissions), Emission)) + geom_boxplot() + theme(axis.text.x = element_text(size=5, angle=45, vjust=0.8, hjust=0.8)) </code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/EDA1-3.png" width="672" /></p>
<pre class="r"><code>library(dplyr)
library(tidyverse)
Agri &lt;- read_csv(&quot;FAOSTAT.csv&quot;, show_col_types = FALSE) 
Agri2 &lt;- 
  Agri %&gt;% filter(Area == &quot;United States of America&quot;) %&gt;%
  filter(str_detect(Element, &quot;CO2eq&quot;)) %&gt;%
  mutate(unit = &quot;tonnes&quot;) %&gt;%
  select(Area, Item, Element,unit, Y2015:Y2019) %&gt;%
  pivot_longer(c(Y2015:Y2019),
               names_to = &quot;year_new&quot;, values_to = &quot;emission&quot;) %&gt;%
  mutate(total = emission * 1000) %&gt;%
  select(-emission) %&gt;%
  arrange(order(year_new)) %&gt;%
  group_by(year_new, Item, Area, unit) %&gt;%
  summarize(sum_emission = sum(total, na.rm = TRUE, count = n()), Element) %&gt;%
  rename(Country = Area, Measure = unit, Emission = sum_emission, Year = year_new, source_of_emissions = Item)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;year_new&#39;, &#39;Item&#39;, &#39;Area&#39;, &#39;unit&#39;. You can
## override using the `.groups` argument.</code></pre>
<pre class="r"><code>Agri2</code></pre>
<pre><code>## # A tibble: 445 × 6
## # Groups:   Year, source_of_emissions, Country, Measure [120]
##    Year  source_of_emissions     Country       Measure  Emission Element        
##    &lt;chr&gt; &lt;chr&gt;                   &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;          
##  1 Y2015 AFOLU                   United State… tonnes     4.47e8 Emissions (CO2…
##  2 Y2015 AFOLU                   United State… tonnes     4.47e8 Emissions (CO2…
##  3 Y2015 AFOLU                   United State… tonnes     4.47e8 Emissions (CO2…
##  4 Y2015 Agricultural Soils      United State… tonnes     9.09e8 Emissions (CO2…
##  5 Y2015 Agricultural Soils      United State… tonnes     9.09e8 Emissions (CO2…
##  6 Y2015 Agricultural Soils      United State… tonnes     9.09e8 Emissions (CO2…
##  7 Y2015 Agricultural Soils      United State… tonnes     9.09e8 Emissions (CO2…
##  8 Y2015 Burning - Crop residues United State… tonnes     9.06e6 Emissions (CO2…
##  9 Y2015 Burning - Crop residues United State… tonnes     9.06e6 Emissions (CO2…
## 10 Y2015 Burning - Crop residues United State… tonnes     9.06e6 Emissions (CO2…
## # … with 435 more rows</code></pre>
<pre class="r"><code>Agri2 %&gt;%
  filter(source_of_emissions == &quot;Emissions on agricultural land&quot; | source_of_emissions == &quot;Farm-gate emissions&quot; | source_of_emissions == &quot;IPCC Agriculture&quot; | 
           source_of_emissions == &quot;AFOLU&quot; | source_of_emissions == &quot;Enteric Fermentation&quot;) %&gt;%
  ggplot(aes(x = source_of_emissions, y = Emission)) +
  geom_point(position = &quot;jitter&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/EDA2-1.png" width="672" /></p>
<pre class="r"><code>Agri2 %&gt;%
  filter(source_of_emissions == &quot;Emissions on agricultural land&quot; | source_of_emissions == &quot;Farm-gate emissions&quot; | source_of_emissions == &quot;IPCC Agriculture&quot; | 
           source_of_emissions == &quot;AFOLU&quot; | source_of_emissions == &quot;Enteric Fermentation&quot;) %&gt;%
  ggplot(aes(factor(source_of_emissions),
                    Emission)) +
  geom_boxplot() + coord_flip()</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/EDA2-2.png" width="672" /></p>
<pre class="r"><code>library(tidyverse)
electricity &lt;- read_csv(&quot;electricity_co2.csv&quot;, show_col_types = FALSE)
electricity1 &lt;- electricity %&gt;%
  filter(State == &quot;State Total&quot;) %&gt;%
  filter(Time &gt; 2014 &amp; Time &lt; 2020) %&gt;%
  select(-Pollutant, -Measure) %&gt;% 
  rename(electricity_emission = Value, year = Time)
electricity1</code></pre>
<pre><code>## # A tibble: 5 × 3
##   State        year electricity_emission
##   &lt;chr&gt;       &lt;dbl&gt;                &lt;dbl&gt;
## 1 State Total  2015                1901.
## 2 State Total  2016                1810.
## 3 State Total  2017                1733.
## 4 State Total  2018                1754.
## 5 State Total  2019                1608.</code></pre>
<pre class="r"><code>mod &lt;- lm(electricity_emission ~ year, data=electricity1)
coeff &lt;- coef(mod)
ggplot(electricity1, aes(year, electricity_emission)) +  geom_abline(intercept = coeff[1], slope = coeff[2], color = &quot;red&quot;, na.rm = FALSE) + geom_point()</code></pre>
<p><img src="{{< blogdown/postref >}}index.en_files/figure-html/modeling-1.png" width="672" /></p>
